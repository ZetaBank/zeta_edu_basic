<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mission &mdash; ZetaBank - Instructor Version</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/toc_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\css\lightbox.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/toc_custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\js\lightbox-plus-jquery.min.js"></script>
        <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Discussion" href="6.discussion.html" />
    <link rel="prev" title="BackgroundNet Coding Explanation" href="4.coding_explanation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Elementary Version
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Day1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Day1/0.index.html">Enjoy AI robot with body</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Day1/1.intro/1.intro.html">Let’s go to AI Exploration Education</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/1.intro/2.team_and_naming.html">Team assignment &amp; Team name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/1.intro/3.catch_monster.html">Catch a troublemaker monster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/1.intro/4.boss_introduce.html">This is the Boss Monster!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day1/2.robot_arm/0.index.html">Control AI Robot Arm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/2.robot_arm/1.follow_along.html">Follow Along!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/2.robot_arm/2.mission.html">Let’s Get Used to the Robot Arm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day1/3.arm_dance/0.index.html">Dance with AI Robot Arm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/3.arm_dance/1.follow_along.html">Follow Along!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day1/3.arm_dance/2.dancing_arm.html">Let’s Introduce Our Team with Music!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day1/5.gotcha.html">Let’s Protect the Earth from Naughty Monsters!</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Day2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Day2/0.index.html">Enjoy AI robot with eyes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Day2/2.AI/0.index.html">AI training with the body and eyes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/5.before_ai_education.html">Before you get AI training…</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/1.index.html">Object Detection with SSD-Mobilenet-v2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/2.follow_along.html">Follow Along!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/3.explanation.html">Overall Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/4.coding_explanation.html">Coding Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/5.mission.html">Mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/1.object_detect/6.discussion.html">Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/1.index.html">Tao Peoplenet Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/2.follow_along.html">Follow Along!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/3.explanation.html">Overall Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/4.coding_explanation.html">Coding Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/5.mission.html">Mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/2.tao_peoplenet/6.discussion.html">Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/1.index.html">Sematic Segmentation Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/2.follow_along.html">Follow Along!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/3.explanation.html">Overall Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/4.coding_explanation.html">Coding Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/5.mission.html">Mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/3.segmentation/6.discussion.html">Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/4.posenet/1.index.html">Body Pose Estimation with Pose-ResNet18-Body</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/4.posenet/2.follow_along.html">Follow Along!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/4.posenet/3.explanation.html">Overall Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/4.posenet/4.coding_explanation.html">Coding Explanation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/4.posenet/5.mission.html">Mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Day2/2.AI/4.posenet/6.discussion.html">Discussion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.AI/6.after_ai_education.html">After you’ve finished AI training…</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day2/2.robot_drive/0.index.html">Control AI Robot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/2.robot_drive/1.follow_along.html">Follow Along!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day2/3.monitor_sensor/0.index.html">Monitor AI Robot Sensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/3.monitor_sensor/1.follow_along.html">Let’s Explore the Inside of the Robot’s Body!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Day2/4.drive_team.html">Control AI Robot as a Team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Day2/5.clean_earth/1.index.html">We save the earth</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/5.clean_earth/2.recycling_garbage.html">Introduction to Recycling Garbage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Day2/5.clean_earth/3.clean_earth.html">Let’s Make a Clean Earth Using AI Robot</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Day3</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../0.index.html">Discuss AI robots</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="1.index.html">Background Removal and Background Change</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="2.follow_along.html">Follow Along!</a></li>
<li class="toctree-l3"><a class="reference internal" href="3.explanation.html">Overall Explanation</a></li>
<li class="toctree-l3"><a class="reference internal" href="4.coding_explanation.html">BackgroundNet Coding Explanation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mission</a></li>
<li class="toctree-l3"><a class="reference internal" href="6.discussion.html">Discussion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../2.presentation.html">Presentation and discussion</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Elementary Version</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../0.index.html">Discuss AI robots</a></li>
          <li class="breadcrumb-item"><a href="1.index.html">Background Removal and Background Change</a></li>
      <li class="breadcrumb-item active">Mission</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Day3/1.background/5.mission.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mission">
<h1>Mission<a class="headerlink" href="#mission" title="Permalink to this heading"></a></h1>
<div style="background: #ffe5b4" class="admonition note custom">
    <p style="background: #ffbf00" class="admonition-title">
        Project Name: Custom Background Removal and Replacement System
    </p>
    <div class="line-block">
        <div class="line"><strong>-</strong> This mission is an <strong>individual project</strong></div>
        <div class="line"><strong>-</strong> First, create a custom program for background removal using BackgroundNet.</div>
        <div class="line"><strong>-</strong> Second, modify the program to incorporate background replacement functionality.</div>
        <div class="line"><strong>-</strong> Execute the mission on your individual computer.  </div>
    </div>
</div><section id="writing-custom-background-removal-program">
<h2>Writing Custom Background Removal Program<a class="headerlink" href="#writing-custom-background-removal-program" title="Permalink to this heading"></a></h2>
<p class="linemarker linemarker-25">Create a new Python file in the Jupyter Notebook environment and name it <code class="docutils literal notranslate"><span class="pre">02_07-2.background_camera.py</span></code>.</p>
<ul>
<li><p class="linemarker linemarker-27">Press the blue plus button on the top left corner of the web.</p>
<a class=""
               data-lightbox="group-7e1dce49-5af6-4a91-945d-7268458b25ec"
               href="../../_images/add_plus1.png"
               title=""
               data-title=""
               
               ><img src="../../_images/add_plus1.png"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="linemarker linemarker-33">Create a new python file by pressing the <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">File</span></code> button</p>
<a class=""
               data-lightbox="group-70b624f8-b6fb-4151-bd8b-e2d352c658b3"
               href="../../_images/pick_python1.png"
               title=""
               data-title=""
               
               ><img src="../../_images/pick_python1.png"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="linemarker linemarker-39">Rename the untitiled python file to <code class="docutils literal notranslate"><span class="pre">02_07-2.</span> <span class="pre">background_camera.py</span></code></p></li>
<li><p class="linemarker linemarker-42">On the new python file, import the libraries necessary. For our Pose Estimation task, we need to import the Jetson inference library modules and jetson utility library modules</p>
<ul class="simple">
<li><p class="linemarker linemarker-44"><code class="docutils literal notranslate"><span class="pre">argparse</span></code>: This library contains modules that are responsbile for bringing and intitializing the flags or parameters set by the user when envoking the program.</p></li>
<li><p class="linemarker linemarker-45"><code class="docutils literal notranslate"><span class="pre">sys</span></code>: this library allows us to manipulate/ utilize system functions within our python programs.</p></li>
<li><p class="linemarker linemarker-47"><code class="docutils literal notranslate"><span class="pre">jetson_inference</span></code>: This library contains all the pre-built networks that can be used for inference task and a functions that would allow for custom models to be used for inference tasks.</p>
<ul>
<li><p class="linemarker linemarker-49"><code class="docutils literal notranslate"><span class="pre">backgroundNet</span></code>: We are importing backgroundNet module for our background removal and change task.</p></li>
</ul>
</li>
<li><p class="linemarker linemarker-52"><code class="docutils literal notranslate"><span class="pre">jetson_utils</span></code>: This library contains modules that are responsible for processing input and output sources along with output stream methods. We will be importing the following modules:</p>
<ul>
<li><p class="linemarker linemarker-54"><code class="docutils literal notranslate"><span class="pre">videoSource</span></code>: used to process input source (whether it is a camera, an image, or a video).</p></li>
<li><p class="linemarker linemarker-55"><code class="docutils literal notranslate"><span class="pre">videoOutput</span></code>: used to process the output stream.</p></li>
<li><p class="linemarker linemarker-56"><code class="docutils literal notranslate"><span class="pre">cudaFont</span></code>: this module allows for overlay on the output stream.</p></li>
<li><p class="linemarker linemarker-57"><code class="docutils literal notranslate"><span class="pre">loadImage</span></code>: this module is used to load images for processing.</p></li>
<li><p class="linemarker linemarker-58"><code class="docutils literal notranslate"><span class="pre">cudaAllocMapped</span></code>: this module is used for allocating mapped memory on the CUDA device.</p></li>
<li><p class="linemarker linemarker-59"><code class="docutils literal notranslate"><span class="pre">cudaMemcpy</span></code>: this module is used for memory copies between the host and device.</p></li>
<li><p class="linemarker linemarker-60"><code class="docutils literal notranslate"><span class="pre">cudaResize</span></code>: this module is used for resizing CUDA images.</p></li>
<li><p class="linemarker linemarker-61"><code class="docutils literal notranslate"><span class="pre">cudaOverlay</span></code>: this module is used for overlaying images on the CUDA output stream.</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">jetson_inference</span> <span class="kn">import</span> <span class="n">backgroundNet</span>
<span class="kn">from</span> <span class="nn">jetson_utils</span> <span class="kn">import</span> <span class="n">videoSource</span><span class="p">,</span> <span class="n">videoOutput</span><span class="p">,</span> <span class="n">loadImage</span><span class="p">,</span> <span class="n">cudaAllocMapped</span><span class="p">,</span> <span class="n">cudaMemcpy</span><span class="p">,</span> <span class="n">cudaResize</span><span class="p">,</span> <span class="n">cudaOverlay</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-73">After all the libraries are imported, initialize the parser variable with <code class="docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code> module.</p>
<p class="linemarker linemarker-75">For our mission, we must receive the network name, and Camera output channel name. Additionally we add 2 other optional parsers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># parse the command line</span>
<span class="c1"># For our mission, We receive the network name and Camera name.</span>
<span class="c1"># Set up argument parser so that command line parameters can be read within the program</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Perform background subtraction/removal.&quot;</span><span class="p">,</span>
                                <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span><span class="p">,</span>
                                <span class="n">epilog</span><span class="o">=</span><span class="n">backgroundNet</span><span class="o">.</span><span class="n">Usage</span><span class="p">()</span> <span class="o">+</span> <span class="n">videoSource</span><span class="o">.</span><span class="n">Usage</span><span class="p">()</span> <span class="o">+</span> <span class="n">videoOutput</span><span class="o">.</span><span class="n">Usage</span><span class="p">())</span>


<span class="c1"># Major Functionality parameters (required from the user)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;input_CAMERA&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;use csi://0 for Raspberry Pi Camera&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--network&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;u2net&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;pre-trained model to load (see below for options)&quot;</span><span class="p">)</span>

<span class="c1"># Minor Functionality parameters (optional)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--filter-mode&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="s2">&quot;linear&quot;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filtering mode used during visualization, options are:</span><span class="se">\n</span><span class="s2">  &#39;point&#39; or &#39;linear&#39; (default: &#39;linear&#39;)&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_known_args</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">print_help</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-101">Initialize the necessary variables.</p>
<ol class="arabic simple">
<li><p class="linemarker linemarker-103"><code class="docutils literal notranslate"><span class="pre">net</span></code> variable for holding the nvidia pre-built networks. For this mission we are using googleNet network.</p></li>
<li><p class="linemarker linemarker-104"><code class="docutils literal notranslate"><span class="pre">input</span></code> variable for handling the input stream. Using the <code class="docutils literal notranslate"><span class="pre">args</span></code> variable created in our previous step, we will bring in input_CAMERA to set our videoSource.</p></li>
<li><p class="linemarker linemarker-105"><code class="docutils literal notranslate"><span class="pre">output</span></code> variable for handling the output stream. We are setting the output stream to be displayed on <code class="docutils literal notranslate"><span class="pre">DISPLAY://0</span></code>.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the background removal network</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">backgroundNet</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">network</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

<span class="c1"># create video sources &amp; outputs</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">videoSource</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_CAMERA</span><span class="p">,</span> <span class="n">argv</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">videoOutput</span><span class="p">(</span><span class="s2">&quot;DISPLAY://0&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-117">Initialize the image replacement routines if the <code class="docutils literal notranslate"><span class="pre">replace</span></code> flag is provided by the user.</p></li>
<li><p class="linemarker linemarker-118">If the <code class="docutils literal notranslate"><span class="pre">replace</span></code> flag is provided, we load the image provided in the flag using the <code class="docutils literal notranslate"><span class="pre">loadImage</span></code> module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># image replacement routines</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">:</span>
    <span class="n">img_replacement</span> <span class="o">=</span> <span class="n">loadImage</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;rgba8&#39;</span><span class="p">)</span>
    <span class="n">img_replacement_scaled</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">img_output</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-128">Create the replaceBackground function to handle the background replacement process.</p></li>
<li><p class="linemarker linemarker-129">This function takes an input image and performs the background replacement using the image loaded in the img_replacement variable.</p></li>
<li><p class="linemarker linemarker-130">It resizes the replacement image if necessary using the cudaResize module.</p></li>
<li><p class="linemarker linemarker-131">Then, it copies the resized replacement image to the img_output variable using the cudaMemcpy module.</p></li>
<li><p class="linemarker linemarker-132">Finally, it overlays the input image with the replacement image using the cudaOverlay module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">replaceBackground</span><span class="p">(</span><span class="n">img_input</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">img_replacement_scaled</span>
    <span class="k">global</span> <span class="n">img_output</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">img_replacement_scaled</span> <span class="ow">or</span> <span class="n">img_input</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">img_replacement_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="n">img_replacement_scaled</span> <span class="o">=</span> <span class="n">cudaAllocMapped</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">img_input</span><span class="p">)</span>
        <span class="n">img_output</span> <span class="o">=</span> <span class="n">cudaAllocMapped</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">img_input</span><span class="p">)</span>
        <span class="n">cudaResize</span><span class="p">(</span><span class="n">img_replacement</span><span class="p">,</span> <span class="n">img_replacement_scaled</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">filter_mode</span><span class="p">)</span>

    <span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">img_output</span><span class="p">,</span> <span class="n">img_replacement_scaled</span><span class="p">)</span>
    <span class="n">cudaOverlay</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="n">img_output</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">img_output</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-151">Process the frames until the end of stream (EOS) or the user exits.
-   Capture the next image from the input source.
-   If the captured image is None (indicating a timeout), continue to the next iteration of the loop.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># capturethe next image (with alpha channel)</span>
    <span class="n">img_input</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">Capture</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;rgba8&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">img_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># timeout</span>
        <span class="k">continue</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-165">Perform background removal using the <code class="docutils literal notranslate"><span class="pre">Process</span></code> function of the <code class="docutils literal notranslate"><span class="pre">net</span></code> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># perform background removal</span>
<span class="n">net</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">img_input</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">filter_mode</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-172">Perform background replacement if the <code class="docutils literal notranslate"><span class="pre">replace</span></code> flag is provided.</p></li>
<li><p class="linemarker linemarker-173">If the flag is provided, call the <code class="docutils literal notranslate"><span class="pre">replaceBackground</span></code> function with the input image.</p></li>
<li><p class="linemarker linemarker-174">Otherwise, set the <code class="docutils literal notranslate"><span class="pre">img_output</span></code> variable to the input image.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># perform background replacement</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">:</span>
    <span class="n">img_output</span> <span class="o">=</span> <span class="n">replaceBackground</span><span class="p">(</span><span class="n">img_input</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">img_output</span> <span class="o">=</span> <span class="n">img_input</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-185">Render the image using the output stream.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># render the image</span>
<span class="n">output</span><span class="o">.</span><span class="n">Render</span><span class="p">(</span><span class="n">img_output</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-192">Update the title bar of the output window with the network name and FPS (frames per second) information.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># update the title bar</span>
<span class="n">output</span><span class="o">.</span><span class="n">SetStatus</span><span class="p">(</span><span class="s2">&quot;backgroundNet </span><span class="si">{:s}</span><span class="s2"> | Network </span><span class="si">{:.0f}</span><span class="s2"> FPS&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">GetNetworkName</span><span class="p">(),</span> <span class="n">net</span><span class="o">.</span><span class="n">GetNetworkFPS</span><span class="p">()))</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-199">Exit the loop if either the input or output stream is not streaming.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># exit on input/output EOS</span>
<span class="k">if</span> <span class="ow">not</span> <span class="nb">input</span><span class="o">.</span><span class="n">IsStreaming</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">IsStreaming</span><span class="p">():</span>
    <span class="k">break</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="executing-the-custom-program">
<h2>Executing the Custom Program<a class="headerlink" href="#executing-the-custom-program" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p class="linemarker linemarker-211">Open the <code class="docutils literal notranslate"><span class="pre">02_07-2.background_camera.py</span></code> notebook.</p></li>
</ul>
<a class=""
               data-lightbox="group-c20c39a8-d823-437e-90e5-0fca663a3102"
               href="../../_images/background_camera1.png"
               title=""
               data-title=""
               
               ><img src="../../_images/background_camera1.png"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a><div class="line-block">
<div class="line"><br /></div>
</div>
<ul>
<li><p class="linemarker linemarker-217">Run the cell code which initializes the input/ output stream of the environment as well as the CAMERA variable, which will be the flag that determines the input vairable for the program to be a camera stream.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">env</span> <span class="n">DISPLAY</span><span class="o">=</span><span class="p">:</span><span class="mi">0</span>
<span class="o">%</span><span class="n">env</span> <span class="n">csi</span><span class="o">=</span><span class="p">:</span><span class="mi">0</span>
<span class="o">%</span><span class="n">env</span> <span class="n">CAMERA</span><span class="o">=</span><span class="n">csi</span><span class="p">:</span><span class="o">//</span><span class="mi">0</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-225">Check if your python notebook can read the python code you have written:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">zeta</span><span class="o">/</span><span class="n">notebook</span><span class="o">/</span><span class="n">lecture</span><span class="o">/</span><span class="s1">&#39;2.AI Training Examples&#39;</span><span class="o">/</span><span class="s1">&#39;02_07-2.background_camera.py&#39;</span>
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-231">Execute the background_camera python code.</p></li>
<li><p class="linemarker linemarker-232">Note that we are setting our major functions,
-   <code class="docutils literal notranslate"><span class="pre">--network</span></code>: to set which networks to use in our background removal task.
-   <code class="docutils literal notranslate"><span class="pre">input_CAMERA</span></code>: to set which input stream will be used for our task. It is being set to CAMERA environment variable which holds <code class="docutils literal notranslate"><span class="pre">csi://0</span></code> as a string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python3 /home/zeta/notebook/lecture/&#39;2.AI Training Examples&#39;/&#39;02_07-2.background_camera.py&#39; --network=u2net $CAMERA
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-241">The program will run and show the output stream with the background removed.</p>
<p class="linemarker linemarker-243">Examples:</p>
<a class=""
               data-lightbox="group-956bdeee-5a08-4ec0-8f73-d80836498288"
               href="../../_images/background_camera_remove1.jpg"
               title=""
               data-title=""
               
               ><img src="../../_images/background_camera_remove1.jpg"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></li>
<li><p class="linemarker linemarker-247">If you want to perform background replacement, add the <code class="docutils literal notranslate"><span class="pre">--replace</span></code> flag followed by the path to the replacement image.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>!python3 /home/zeta/notebook/lecture/&#39;2.AI Training Examples&#39;/&#39;02_07-2.background_camera.py&#39; --replace=images/coral.jpg $CAMERA
</pre></div>
</div>
</li>
<li><p class="linemarker linemarker-254">The program will run and show the output stream with the background removed and replaced with the specified image.</p>
<p class="linemarker linemarker-256">Examples:</p>
<a class=""
               data-lightbox="group-f3a0dbb1-1530-4072-8aa3-284b7529ec97"
               href="../../_images/background_camera_replace1.jpg"
               title=""
               data-title=""
               
               ><img src="../../_images/background_camera_replace1.jpg"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></li>
<li><p class="linemarker linemarker-260">Feel free to experiment with different replacement images and settings to achieve your desired result!</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="4.coding_explanation.html" class="btn btn-neutral float-left" title="BackgroundNet Coding Explanation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="6.discussion.html" class="btn btn-neutral float-right" title="Discussion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-17821189-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-17821189-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>